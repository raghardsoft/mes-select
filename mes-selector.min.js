let MesSelectorInstances=[],currentlyOpenSelector=null,globalListenersAdded=!1;const globalHandlers={handleDocumentClick:function(e){if(currentlyOpenSelector&&currentlyOpenSelector.config.closeOnClickOutside){const t=e.target.closest(".mes-selector-header");if(t&&t!==currentlyOpenSelector.header)return;currentlyOpenSelector.container.contains(e.target)||currentlyOpenSelector.close()}},handleKeydown:function(e){"Escape"===e.key&&currentlyOpenSelector&&currentlyOpenSelector.close()},handleResize:function(){currentlyOpenSelector&&(currentlyOpenSelector.isMobile=currentlyOpenSelector.detectMobile(),currentlyOpenSelector.isOpen&&currentlyOpenSelector.positionOptions())}};class MesSelectorManager{static init(){globalListenersAdded||(document.addEventListener("click",globalHandlers.handleDocumentClick),document.addEventListener("keydown",globalHandlers.handleKeydown),window.addEventListener("resize",globalHandlers.handleResize),globalListenersAdded=!0)}static destroyAll(){MesSelectorInstances.forEach((e=>{e.destroy()})),MesSelectorInstances=[],currentlyOpenSelector=null}static closeAllSelectors(e=null){MesSelectorInstances.forEach((t=>{t!==e&&t.isOpen&&t.close()}))}}class MesSelector{constructor(e,t,s={}){if(this.defaults={placeholder:"Selecciona un mes",required:!1,locale:"es",minDate:null,maxDate:null,minYear:1900,maxYear:2100,disabled:!1,showIcon:!0,showTodayBtn:!0,showClearBtn:!0,showYearNav:!0,mobileOverlay:!0,closeOnClickOutside:!0,autoCloseOtherSelectors:!0,onChange:null,onOpen:null,onClose:null,theme:"default"},this.config={...this.defaults,...s},!e||!t)return;const n=MesSelectorInstances.find((s=>s.containerId===e&&s.inputId===t));n&&n.destroy(),this.containerId=e,this.inputId=t,this.container=document.getElementById(e),this.input=document.getElementById(t),this.container&&this.input&&(this.isMobile=this.detectMobile(),this.minDate=this.parseDate(this.config.minDate),this.maxDate=this.parseDate(this.config.maxDate),this.meses=this.getMonths(),this.currentYear=(new Date).getFullYear(),this.selectedYear=null,this.selectedMonth=null,this.isOpen=!1,this.overlay=null,MesSelectorManager.init(),this.init(),this.attachEvents(),this.input.value&&this.setValue(this.input.value),"default"!==this.config.theme&&this.container.classList.add(`theme-${this.config.theme}`),this.config.disabled&&this.disable(),MesSelectorInstances.push(this),"undefined"!=typeof window&&(window._mesSelectors=window._mesSelectors||[],window._mesSelectors.push(this)),this.isTouchDevice=this.detectTouchDevice(),this.isIOS=this.detectIOS())}detectTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}detectIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}detectMobile(){return window.innerWidth<=768}parseDate(e){if(!e)return null;if("string"==typeof e){const t=e.match(/^(\d{4})-(\d{2})/);if(t)return{year:parseInt(t[1]),month:parseInt(t[2])}}else if(e instanceof Date)return{year:e.getFullYear(),month:e.getMonth()+1};return null}getMonths(){return"es"===this.config.locale?["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]:["January","February","March","April","May","June","July","August","September","October","November","December"]}init(){this.container.querySelector(".mes-selector-header")&&(this.container.innerHTML=""),this.container.className="mes-selector-container";const e=this.config.showYearNav?`\n            <div class="mes-year-section">\n                <button type="button" class="mes-nav-btn mes-prev-year" aria-label="AÃ±o anterior">â—€</button>\n                <span class="mes-current-year">${this.currentYear}</span>\n                <button type="button" class="mes-nav-btn mes-next-year" aria-label="Siguiente aÃ±o">â–¶</button>\n            </div>\n        `:`\n            <div class="mes-year-section">\n                <span class="mes-current-year">${this.currentYear}</span>\n            </div>\n        `,t=[];this.config.showTodayBtn&&("es"===this.config.locale?t.push('<button type="button" class="mes-action-btn mes-today-btn">Mes actual</button>'):t.push('<button type="button" class="mes-action-btn mes-today-btn">Current month</button>')),this.config.showClearBtn&&("es"===this.config.locale?t.push('<button type="button" class="mes-action-btn mes-clear-btn">Limpiar</button>'):t.push('<button type="button" class="mes-action-btn mes-clear-btn">Clear</button>'));const s=t.length>0?`\n            <div class="mes-buttons">\n                ${t.join("")}\n            </div>\n        `:"",n=this.config.showIcon?'<span class="icon">ðŸ“…</span>':"",i=this.config.showIcon?"padding-left: 45px;":"padding-left: 20px;";this.container.innerHTML=`\n            <div class="mes-selector-header" style="${i}">\n                ${n}\n                <span class="mes-placeholder">${this.config.placeholder}</span>\n                <span class="mes-selected-value"></span>\n                <span class="arrow">â–¼</span>\n            </div>\n            <div class="mes-options">\n                ${e}\n                <div class="mes-grid"></div>\n                ${s}\n            </div>\n        `,this.header=this.container.querySelector(".mes-selector-header"),this.options=this.container.querySelector(".mes-options"),this.yearElement=this.container.querySelector(".mes-current-year"),this.monthsGrid=this.container.querySelector(".mes-grid"),this.prevYearBtn=this.container.querySelector(".mes-prev-year"),this.nextYearBtn=this.container.querySelector(".mes-next-year"),this.todayBtn=this.container.querySelector(".mes-today-btn"),this.clearBtn=this.container.querySelector(".mes-clear-btn"),this.selectedValue=this.container.querySelector(".mes-selected-value"),this.renderMonths()}createOverlay(){if(this.overlay)return;this.overlay=document.createElement("div"),this.overlay.className="mes-overlay",this.overlay.dataset.selectorId=this.containerId,document.body.appendChild(this.overlay);const e=e=>{e.target===this.overlay&&this.isOpen&&this.close()};this.overlay._closeHandler=e,this.overlay.addEventListener("click",e)}removeOverlay(){this.overlay&&(this.overlay._closeHandler&&this.overlay.removeEventListener("click",this.overlay._closeHandler),this.overlay.remove(),this.overlay=null)}attachEvents(){this.removeEvents();const e=e=>{const t=e.target;if(t===this.header||t.closest(".mes-selector-header"))this.config.disabled||(this.isOpen?this.close():(this.config.autoCloseOtherSelectors&&MesSelectorManager.closeAllSelectors(this),this.open()),e.stopPropagation());else if(this.prevYearBtn&&t.closest(".mes-prev-year"))this.prevYear();else if(this.nextYearBtn&&t.closest(".mes-next-year"))this.nextYear();else if(this.todayBtn&&t.closest(".mes-today-btn"))this.selectToday();else if(this.clearBtn&&t.closest(".mes-clear-btn"))this.clear();else if(t.closest(".mes-grid-btn")){const e=t.closest(".mes-grid-btn");if(!e.disabled){const t=parseInt(e.dataset.month);this.selectMonth(t)}}};this._clickHandler=e,this.container.addEventListener("click",e);const t=this.input.closest("form");if(t){const e=()=>{setTimeout((()=>this.clear()),0)};this._formResetHandler=e,t.addEventListener("reset",e)}this.isTouchDevice&&this.setupTouchEvents()}setupTouchEvents(){[this.prevYearBtn,this.nextYearBtn,this.todayBtn,this.clearBtn].forEach((e=>{e&&(e.addEventListener("touchstart",(t=>{this.isTouchDevice&&(e.classList.add("active-touch"),t.preventDefault())})),e.addEventListener("touchend",(t=>{this.isTouchDevice&&(e.classList.remove("active-touch"),this.isIOS&&(e.classList.add("ios-touch"),setTimeout((()=>{e.classList.remove("ios-touch")}),300)))})),e.addEventListener("touchcancel",(t=>{this.isTouchDevice&&e.classList.remove("active-touch","ios-touch")})))})),this.monthsGrid.addEventListener("touchstart",(e=>{const t=e.target.closest(".mes-grid-btn");t&&this.isTouchDevice&&(t.classList.add("active-touch"),e.preventDefault())})),this.monthsGrid.addEventListener("touchend",(e=>{const t=e.target.closest(".mes-grid-btn");t&&this.isTouchDevice&&(t.classList.remove("active-touch"),this.isIOS&&(t.classList.add("ios-touch"),setTimeout((()=>{t.classList.remove("ios-touch")}),300)))}))}removeEvents(){if(this._clickHandler&&(this.container.removeEventListener("click",this._clickHandler),this._clickHandler=null),this._formResetHandler){const e=this.input.closest("form");e&&e.removeEventListener("reset",this._formResetHandler),this._formResetHandler=null}this.removeOverlay()}positionOptions(){if(this.isOpen)if(this.isMobile&&this.config.mobileOverlay){if(this.options.style.position="fixed",this.options.style.animation="mesSlideDownMobile 0.2s ease-out forwards",this.options.style.transform="translate(-50%, -50%)",this.options.style.width="90vw",this.options.style.maxWidth="320px",this.isIOS()){const e=window.innerHeight,t=this.options.offsetHeight,s=Math.max(20,(e-t)/2);this.options.style.top=`${s}px`,this.options.style.transform="translate(-50%, 0)"}}else this.options.style.position="absolute",this.options.style.top="calc(100% + 8px)",this.options.style.left="0",this.options.style.transform="none",this.options.style.width="320px"}isMonthDisabled(e,t){return!(!this.minDate||!(e<this.minDate.year||e===this.minDate.year&&t<this.minDate.month))||!(!this.maxDate||!(e>this.maxDate.year||e===this.maxDate.year&&t>this.maxDate.month))}renderMonths(){this.yearElement.textContent=this.currentYear,this.monthsGrid.innerHTML="";const e=new Date,t=e.getFullYear(),s=e.getMonth()+1;this.prevYearBtn&&(this.prevYearBtn.disabled=this.currentYear<=this.config.minYear),this.nextYearBtn&&(this.nextYearBtn.disabled=this.currentYear>=this.config.maxYear),this.meses.forEach(((e,n)=>{const i=n+1,o=document.createElement("button");o.type="button",o.className="mes-grid-btn",o.textContent=e,o.dataset.month=i,this.currentYear===t&&i===s&&o.classList.add("today"),this.selectedYear===this.currentYear&&this.selectedMonth===i&&o.classList.add("selected"),this.isMonthDisabled(this.currentYear,i)&&(o.disabled=!0,o.classList.add("disabled")),this.monthsGrid.appendChild(o)}))}prevYear(){this.currentYear>this.config.minYear&&(this.currentYear--,this.renderMonths())}nextYear(){this.currentYear<this.config.maxYear&&(this.currentYear++,this.renderMonths())}selectMonth(e){if(this.isMonthDisabled(this.currentYear,e))return;this.selectedYear=this.currentYear,this.selectedMonth=e;const t=`${this.meses[e-1]} ${"es"===this.config.locale?"de":" "} ${this.selectedYear}`;this.selectedValue.textContent=t,this.container.classList.add("has-value");const s=e.toString().padStart(2,"0"),n=`${this.selectedYear}-${s}`;this.input.value=n,this.input.dispatchEvent(new Event("change",{bubbles:!0})),this.input.dispatchEvent(new Event("input",{bubbles:!0})),"function"==typeof this.config.onChange&&this.config.onChange(n,this.getDate()),this.close(),this.renderMonths()}selectToday(){const e=new Date,t=e.getFullYear(),s=e.getMonth()+1;this.isMonthDisabled(t,s)||(this.currentYear=t,this.selectMonth(s))}open(){this.isOpen||this.config.disabled||(this.config.autoCloseOtherSelectors&&MesSelectorManager.closeAllSelectors(this),this.isOpen=!0,this.header.classList.add("active"),this.options.classList.add("show"),currentlyOpenSelector=this,this.selectedYear?this.currentYear=this.selectedYear:this.currentYear=(new Date).getFullYear(),this.renderMonths(),this.isMobile&&this.config.mobileOverlay&&(this.createOverlay(),this.overlay.style.display="block",document.body.style.overflow="hidden",this.isIOS&&document.body.classList.add("mes-selector-open")),this.positionOptions(),this.isIOS()&&(this.options.offsetWidth,setTimeout((()=>{this.positionOptions()}),10)),"function"==typeof this.config.onOpen&&this.config.onOpen())}close(){this.isOpen&&(this.isOpen=!1,this.header.classList.remove("active"),this.options.classList.remove("show"),currentlyOpenSelector===this&&(currentlyOpenSelector=null),this.removeOverlay(),document.body.style.overflow="",this.isIOS&&document.body.classList.remove("mes-selector-open"),"function"==typeof this.config.onClose&&this.config.onClose())}clear(){this.selectedYear=null,this.selectedMonth=null,this.input.value="",this.container.classList.remove("has-value"),this.container.classList.remove("error"),this.input.dispatchEvent(new Event("change",{bubbles:!0})),this.input.dispatchEvent(new Event("input",{bubbles:!0})),"function"==typeof this.config.onChange&&this.config.onChange("",null),this.renderMonths()}setValue(e){if(!e)return this.clear(),this;const t=e.match(/^(\d{4})-(\d{2})/);if(!t)return this;const s=parseInt(t[1]),n=parseInt(t[2]);if(n<1||n>12)return this;if(this.isMonthDisabled(s,n))return this;this.selectedYear=s,this.selectedMonth=n,this.currentYear=s;const i=`${this.meses[n-1]} ${"es"===this.config.locale?"de":" "} ${s}`;this.selectedValue.textContent=i,this.container.classList.add("has-value");const o=n.toString().padStart(2,"0");return this.input.value=`${s}-${o}`,this.renderMonths(),"function"==typeof this.config.onChange&&this.config.onChange(this.input.value,this.getDate()),this}getValue(){return this.input.value}getDisplayValue(){return this.selectedYear&&this.selectedMonth?`${this.meses[this.selectedMonth-1]} de ${this.selectedYear}`:""}getDate(){return this.selectedYear&&this.selectedMonth?new Date(this.selectedYear,this.selectedMonth-1,1):null}getYearMonth(){return this.selectedYear&&this.selectedMonth?{year:this.selectedYear,month:this.selectedMonth}:null}disable(){this.config.disabled=!0,this.header.style.opacity="0.6",this.header.style.cursor="not-allowed",this.input.disabled=!0,this.close()}enable(){this.config.disabled=!1,this.header.style.opacity="1",this.header.style.cursor="pointer",this.input.disabled=!1}isValid(){return!!this.input.value&&this.input.validity.valid}showError(e){this.container.classList.add("error");let t=this.container.nextElementSibling;t&&t.classList.contains("mes-validation-message")||(t=document.createElement("div"),t.className="mes-validation-message",this.container.parentNode.insertBefore(t,this.container.nextSibling)),t.textContent=e,t.style.display="block"}hideError(){this.container.classList.remove("error");const e=this.container.nextElementSibling;e&&e.classList.contains("mes-validation-message")&&(e.style.display="none")}destroy(){this.close(),this.removeEvents();const e=MesSelectorInstances.indexOf(this);if(e>-1&&MesSelectorInstances.splice(e,1),window._mesSelectors){const e=window._mesSelectors.indexOf(this);e>-1&&window._mesSelectors.splice(e,1)}currentlyOpenSelector===this&&(currentlyOpenSelector=null),this.container.innerHTML="",this.container.className="",this.header=null,this.options=null,this.yearElement=null,this.monthsGrid=null,this.prevYearBtn=null,this.nextYearBtn=null,this.todayBtn=null,this.clearBtn=null,this.selectedValue=null,this.input=null,this.container=null}refresh(){const e=document.getElementById(this.containerId),t=document.getElementById(this.inputId);return e&&t?e===this.container&&t===this.input||(this.container=e,this.input=t,this.removeEvents(),this.init(),this.attachEvents(),!0):(this.destroy(),!1)}}"undefined"!=typeof window&&(window.MesSelector=MesSelector,window.MesSelectorManager=MesSelectorManager,window.cleanupMesSelectors=function(){MesSelectorManager.destroyAll()},window.addEventListener("beforeunload",(function(){cleanupMesSelectors()})));